# Rime schema
# encoding: utf-8

schema:
  schema_id: gnincieu_lianfen
  name: 寧波話兩分（鄞州）
  version: "0.1.1"
  author:
    - 天珩 <2417647441@qq.com>
    - Shin Zoqchiuq <shinzoqchiuq@outlook.com>
  description: |-
    基於 [字海](http://zisea.com/) 兩分輸入方案的寧波話兩分輸入方案（鍾公廟、首南附近口音）。

switches:
  - name: ascii_mode
    states: [中文, 英文]
  - name: full_shape
    states: [半角, 全角]
  - name: ascii_punct
    states: [。，, ．，]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - table_translator
  filters:
    - simplifier
    - uniquifier
    - reverse_lookup_filter

speller:
  alphabet: abcdefghijklmnopqrstuvwxyz
  delimiter: " '"
  algebra:
    - xform/(\w*)-(\w*)/$2/
    - xform/(\w*)-(\w*)/$2/
    - xform/(\by|i)u(?=n)/$1o/
    - derive/([pb]|ph)un/$1oe/
    - xform/mun/moe/
    - xform/uo/o/
    - xform/wo/gho/
    - erase/(\b|c|j|gn|kn|[csz]h)(y|i)o\b/
    - erase/\b-\b/

    # 兼容吳語協會式拼音
    - derive/q/h/
    - derive/(i|y)au/$1o/
    - derive/([gk])ni(?=[nqh]|\d|\b)/nyi/
    - derive/([gk])ni(?=[aoue])/ny/
    - derive/(?<=[szh])yu(?=[nqh])/oe/
    - derive/er/r/

    # 胡 ≈ 符
    - derive/wu\b/vu/
    - derive/vu\b/wu/
    # 卵 ≈ 漏
    - derive/loe/leu/

    # 新派

    # 且 ≈ 采
    - derive/c(h)?ie\b/ts$1e/
    - derive/jie\b/dze/
    - derive/(?<=[sz])hie\b/e/
    - derive/\bye\b/ghe/
    # 降 ≈ 壯
    - derive/ciaon/tsaon/
    # 穿 ≈ 秋
    - derive/ts(h)?oe\b/c$1ieu/
    - derive/dzoe\b/jieu/
    - derive/\b(s|z)oe\b/$1hieu/
    # 官 ≈ 孤
    - derive/(?<![iy])un/u/
    # 春 ≈ 充，出 ≈ 促
    - derive/(?<=[szh])(yu|oe)(?=[nqh])/o/
    # 允 ≈ 用，缺 ≈ 喫
    - derive/(\by|i)u(?=[nqh])/$1o/
    - derive/(\by|i)o(?=[nqh])/$1u/
    # 削 ≈ 吸
    - derive/ia(?=q|h)/i/
    - derive/ya(?=q|h)/yi/

    # 清鼻邊音
    - derive/([mnl])h/$1/
    - derive/kn/gn/
    - derive/nk/ng/
    # 容錯 gn(ny) => n kn => nh
    - derive/(gn|ny)i/ni/
    - derive/kni/nhi/
    - derive/ny(?=[aoue])/ni/
    # 容錯 un => oe
    - derive/([pbmw]|ph)un/$1oe/
    - derive/\b([kgh]|kh)?un/$1uoe/
    # 容錯 au => ao
    - derive/au/ao/
    # c組聲母後自動加i
    - derive/\b(c|j|gn|kn|[csz]h)i(?=[aoue])/$1/
    # 容錯 介音、主元音順序調換
    - derive/\b(.+)([iu])([aeou])([euonqh])\b/$1$3$2$4/
    # 容錯 oe => eo
    - derive/oe/eo/
    # 容錯 ao => oa
    - derive/ao/oa/
    # 容錯 ae => ea
    - derive/ae/ea/

    - xform/=//

translator:
  dictionary: gninpou_lianfen
  prism: gnincieu_lianfen

punctuator:
  import_preset: default

key_binder:
  import_preset: default

recognizer:
  import_preset: default
